<VirtualHost *:443>
    ServerName stream.maelsh.pro
    
    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /path/to/cert.pem
    SSLCertificateKeyFile /path/to/privkey.pem
    
    # Enable proxy modules
    ProxyRequests Off
    ProxyPreserveHost On
    
    # WebSocket proxy
    ProxyPass /signaling ws://localhost:3000/signaling
    ProxyPassReverse /signaling ws://localhost:3000/signaling
    
    # HTTP proxy for API
    ProxyPass / http://localhost:3000/
    ProxyPassReverse / http://localhost:3000/
    
    # WebSocket upgrade headers
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/?(.*) "ws://localhost:3000/$1" [P,L]
    
    # Logs
    ErrorLog ${APACHE_LOG_DIR}/streaming-error.log
    CustomLog ${APACHE_LOG_DIR}/streaming-access.log combined
</VirtualHost>
