# ๐ค ูููู 7: ุชูุซูู Shared & Routes & Main

ูุฐุง ุงููุณุชูุฏ ููุฏู ุชูุตูููุง ุดุงููุงู ููููุงุช ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ ูุงููุณุงุฑุงุช ูุงูููููุงุช ุงููุดุชุฑูุฉ ูู ููุตุฉ ุฏูููู.

---

## โ๏ธ ุงูููู ุงูุฃูู: src/main.ts 

### ุงูุบุฑุถ
ูุนุชุจุฑ ูุฐุง ุงูููู ูู ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ (Entry Point) ููุชุทุจูู ูู ุฌูุฉ ุงูุฎุงุฏู. ูุชู ููู ุชููุฆุฉ ุชุทุจูู Honoุ ุฑุจุท ุงูุจุฑูุฌูุงุช ุงููุณูุทุฉ (Middleware)ุ ูุชุณุฌูู ูุงูุฉ ุงููุณุงุฑุงุช (Page & API Routes).

### ุชุฑุชูุจ ุงูู Middleware (ููู ุฌุฏุงู!)
ูุชุจุน Hono ุชุฑุชูุจุงู ุชุณูุณููุงู ูู ุชูููุฐ ุงูู Middlewareุ ููุฐุง ูู ุงูุชุฑุชูุจ ุงููุชุจุน ูู ุงููุดุฑูุน:

| ุงูุชุฑุชูุจ | ุงูู Middleware | ุงููุทุงู | ุงูุบุฑุถ |
|---------|---------------|--------|-------|
| 1 | `cors()` | `/api/*` | ุงูุณูุงุญ ุจุงูุทูุจุงุช ุงูุนุงุจุฑุฉ ููููุงูุน ููุณุงุฑุงุช ุงูู API. |
| 2 | `Language Middleware` | `*` (ุงููู) | ุชุญุฏูุฏ ูุบุฉ ุงูุนุฑุถ ุจูุงุกู ุนูู: 1. `lang` query paramุ 2. `lang` cookieุ 3. ุงููุบุฉ ุงูุงูุชุฑุงุถูุฉ. |

### ุชุณุฌูู ุงูู Routes
ูููุณู ุชุณุฌูู ุงููุณุงุฑุงุช ุฅูู ุซูุงุซุฉ ุฃูุณุงู ุฑุฆูุณูุฉ:

#### 1. ูุณุงุฑุงุช ุงูู API:
ุชู ุงุณุชุฎุฏุงู `app.route()` ูุฑุจุท ูุญุฏุงุช ุงูู API ุงููุฎุชููุฉ:
- `/api/categories`: ุชุตูููุงุช ุงูููุงูุณุงุช.
- `/api/competitions`: ุงูููุงูุณุงุช ูุงูุนูููุงุช ุนูููุง.
- `/api/users`: ุจูุงูุงุช ุงููุณุชุฎุฏููู ูุงููููุงุช ุงูุดุฎุตูุฉ.
- `/api/notifications`: ุงูุชูุจููุงุช.
- `/api/auth` & `/api/auth/oauth`: ูุธุงู ุงููุตุงุฏูุฉ ูุชุณุฌูู ุงูุฏุฎูู (ุงูุนุงุฏู ูุงูุงุฌุชูุงุนู).
- `/api/countries`: ูุงุฆูุฉ ุงูุฏูู ูุงููุบุงุช.
- `/api/jitsi`: ุฅุนุฏุงุฏุงุช ุบุฑู Jitsi.
- `/api/signaling`: ูุธุงู ุงูุฅุดุงุฑุงุช ููุจุซ ุงููุจุงุดุฑ.
- `/api/chunks`: ุงูุชุนุงูู ูุน ูุทุน ุงูุจูุงูุงุช.
- ูุงููุฒูุฏ ูู ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ (Search, Likes, Reports, Messages, Admin, Settings, Schedule).

#### 2. ูุณุงุฑุงุช ุงูุตูุญุงุช ุงูุซุงุจุชุฉ (Static Pages):
- `/`: ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (ูุชู ุจูุงุคูุง ุฏููุงููููุงู ุฏุงุฎู `main.ts`).
- ูุณุงุฑุงุช ุฃุฎุฑู ูุซู `/about`, `/explore`, `/profile`, ุฅูุฎุ ูุชู ุงุณุชูุฑุงุฏูุง ูู `modules/pages`.

#### 3. ูุณุงุฑุงุช ุงูุจุซ ุงููุจุงุดุฑ (Live Stream):
- `/live`: ูุณุงุฑุงุช ุฅุฏุงุฑุฉ ุงูุจุซ ุงููุจุงุดุฑ.

### ุงูู Error Handling
- **404 Not Found**: ูุชู ุงูุชุนุงูู ูุนู ุนุจุฑ `app.notFound()`ุ ุญูุซ ูุนุฑุถ ุตูุญุฉ 404 ูุฎุตุตุฉ ุจูุบุฉ ุงููุณุชุฎุฏู ุงูุญุงููุฉ ุจุงุณุชุฎุฏุงู ูุงูุจ `layout`.
- **Global Error Handler**: ูุชู ุนุจุฑ `app.onError()`ุ ุญูุซ ูุณุฌู ุงูุฎุทุฃ ูู ุงููููุณูู ููุนูุฏ ุฑุณุงูุฉ ุฎุทุฃ ุจุณูุทุฉ ูููุณุชุฎุฏู ูุน ููุฏ ุญุงูุฉ 500.

### ุงูู App Initialization Steps
1. ุงุณุชูุฑุงุฏ ุงูููุชุจุงุช (Hono).
2. ุงุณุชูุฑุงุฏ ุชุนุฑููุงุช ุงูุฃููุงุน ูุงููุบุงุช.
3. ุงุณุชูุฑุงุฏ ูุฌูุนุงุช ุงููุณุงุฑุงุช (API & Pages).
4. ุฅูุดุงุก ูุซูู `app = new Hono()`.
5. ุชุนุฑูู ุงูู Middleware (CORS, Language).
6. ุชุฑููุจ (Mount) ูุณุงุฑุงุช ุงูู API.
7. ุชุนุฑูู ูุณุงุฑ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ `/` ูุชูููุฏ ุงูู HTML ุงูุฎุงุต ุจูุง.
8. ุชุฑููุจ ูุณุงุฑุงุช ุงูุตูุญุงุช ุงูุฃุฎุฑู.
9. ุชุนุฑูู ูุนุงูุฌุงุช ุงูุฃุฎุทุงุก.

---

## ๐ ุงูููููุงุช ุงููุดุชุฑูุฉ: src/shared/components/

### 1. ุงูููู: `src/shared/components/competition-card.ts`
**ุงูุบุฑุถ:** ุนุฑุถ ูุงุฑุช ุงูููุงูุณุฉ (UI Component).

| ุงูู Prop | ุงูููุน | ุงูุบุฑุถ |
|----------|-------|-------|
| `item` | `CompetitionCardProps` | ุจูุงูุงุช ุงูููุงูุณุฉ (ุงูุนููุงูุ ุงููุชูุงูุณููุ ุงูุญุงูุฉุ ุงููุดุงูุฏุงุชุ ุฅูุฎ). |
| `lang` | `Language` | ูุบุฉ ุงูุนุฑุถ. |

**ุงูู HTML Structure:**
- ุญุงููุฉ ุฑุฆูุณูุฉ `duel-card` ุชุถู ุฑุงุจุทุงู ููููุงูุณุฉ.
- ูุณู ุนููู (Thumbnail) ูุญุชูู ุนูู:
    - ุชุฏุฑุฌ ูููู ุฎููู ููููุด ุฃููููุงุช ุนุดูุงุฆูุฉ (Scattered Icons).
    - ุตูุฑ ุงููุชูุงูุณูู (Avatar) ูุน ุฃููููุฉ VS ูู ุงูููุชุตู.
    - ููุตูุงุช ุงูุญุงูุฉ (Live, Pending, Recorded).
    - ุชูุงุตูู ุงูููุช ูุงููุดุงูุฏุงุช ูุงูุฅุนุฌุงุจุงุช.
- ูุณู ุณููู ูุญุชูู ุนูู ุนููุงู ุงูููุงูุณุฉ ูุฃุณูุงุก ุงููุชูุงูุณูู.

---

### 2. ุงูููู: `src/shared/components/competition-section.ts`
**ุงูุบุฑุถ:** ุนุฑุถ ูุณู ูุญุชูู ุนูู ูุฌููุนุฉ ูู ูุฑูุช ุงูููุงูุณุงุช ูุน ุฅููุงููุฉ ุงูุชูุฑูุฑ (Horizontal Scroll).

| ุงูู Parameter | ุงูููุน | ุงูุบุฑุถ |
|---------------|-------|-------|
| `title` | `string` | ุนููุงู ุงููุณู. |
| `items` | `CompetitionCardProps[]` | ูุงุฆูุฉ ุงูููุงูุณุงุช ููุนุฑุถ. |
| `icon` | `string` | ุฃููููุฉ ุงููุณู (FontAwesome). |
| `lang` | `Language` | ูุบุฉ ุงูุนุฑุถ. |
| `color` | `string` | ุงูููู ุงูุฑุฆูุณู ูููุณู. |

**ุงูู Functions:**
- `getCompetitionSection`: ุชุฌูุน ุงููููู ุจุงููุงูู ูุชุฏูุฑ ุนูููุงุช ุงูุชูุฑูุฑ ุงูุจุฑูุฌูุฉ (scrollBy).

---

### 3. ุงูููู: `src/shared/components/navigation.ts`
**ุงูุบุฑุถ:** ุดุฑูุท ุงูุชููู ุงูุนููู (Navigation Bar).

**ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:**
- **Logo**: ุฑุงุจุท ููุฑุฆูุณูุฉ ูุน ุดุนุงุฑ ุฏูููู.
- **Language/Country Switcher**: ูุงุฆูุฉ ููุณุฏูุฉ ูุงุฎุชูุงุฑ ุงูุฏููุฉ ูุงููุบุฉ.
- **Dark Mode Toggle**: ุฒุฑ ุงูุชุจุฏูู ุจูู ุงููุถุน ุงููููู ูุงูููุงุฑู.
- **Auth Section**: ูุธูุฑ ุฒุฑ ุงูุฏุฎูู ููุฒูุงุฑุ ุฃู ูุงุฆูุฉ ุงููุณุชุฎุฏู ููุฃุนุถุงุก.
- **Notifications & Messages**: ุฃููููุงุช ูุน ุดุงุฑุงุช (Badges) ููุนุฏุฏ ูุชูุจููุงุช ููุณุฏูุฉ.
- **User Menu**: ูุงุฆูุฉ ุดุงููุฉ ููููู ุงูุดุฎุตูุ ุงููุญูุธุฉุ ุงูุฅุนุฏุงุฏุงุชุ ูุชุณุฌูู ุงูุฎุฑูุฌ.

---

### 4. ุงูููู: `src/shared/components/login-modal.ts`
**ุงูุบุฑุถ:** ูุงูุฐุฉ ููุจุซูุฉ ูููุตุงุฏูุฉ (Login/Register/Reset Password).

**ุงูููููุงุช ุงููุฑุนูุฉ:**
- `getLoginModal`: ุงููููู ุงูุฑุฆูุณู ูููุงูุฐุฉ.
- `getRegisterForm`: ูููุฐุฌ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ.
- `getForgotPasswordForm`: ูุธุงู ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ ุงููููู ูู 3 ุฎุทูุงุช (ุงูุฃูููู -> ููุฏ ุงูุชุญูู -> ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ).
- **Social Login**: ุฃุฒุฑุงุฑ ุงูุฏุฎูู ุนุจุฑ Google ู Outlook (ูุบูุฑูุง ุฌุงูุฒุฉ ููุชูุนูู).

---

### 5. ุงูููู: `src/shared/components/user-card.ts`
**ุงูุบุฑุถ:** ุนุฑุถ ูุงุฑุช ูุณุชุฎุฏู ุจุณูุท (ูุณุชุฎุฏู ูู ุงูุจุญุซ ูุงููุชุงุจุนูู).

| ุงูุงุณู | ุงูููุน | ุงูุบุฑุถ |
|-------|-------|-------|
| `user` | `UserCardProps` | ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุฃุณุงุณูุฉ. |

---

### 6. ุงูููู: `src/shared/components/footer.ts`
**ุงูุบุฑุถ:** ุชุฐููู ุงูุตูุญุฉ ุงูุจุณูุท ุงูุฐู ูุญุชูู ุนูู ุญููู ุงูููููุฉ ูุดุนุงุฑ ุงูุชุทุจูู.

---

## ๐ ููุงูุจ ุงูุตูุญุงุช: src/shared/templates/

### ุงูููู: `src/shared/templates/layout.ts`

**ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ:** `generateHTML(content, lang, title)`
**ุงูุบุฑุถ:** ุชุบููู ูุญุชูู ุงูุตูุญุฉ ูู ูููู HTML ุฃุณุงุณู ูุชุถูู:
- ุงูู Meta tags ููุฌูุงู ูุงูู PWA.
- ุฑูุงุจุท ุงูุฎุทูุท (Cairo ููุนุฑุจูุฉุ Inter ููุฅูุฌููุฒูุฉ).
- ุฑุงุจุท ููู ุงูุณุชุงูู `styles.css`.
- ุฑุจุท ููู ุงูุฌุงูุงุณูุฑูุจุช ุงูุฑุฆูุณู `app.js`.
- ุชุณุฌูู ุงูู Service Worker ููููุฒุงุช ุงูู PWA.
- ุฅุฏุงุฑุฉ ุงุชุฌุงู ุงููุต (RTL/LTR) ูุงูุฎุทูุท ุจูุงุกู ุนูู ุงููุบุฉ.

---

## ๐ ุงููุณุงุฑุงุช: src/routes/ (โ๏ธ ููููุฉ)

**ููุงุญุธุฉ ูุงูุฉ:** ูุงูุฉ ุงููููุงุช ูู ูุฐุง ุงููุฌูุฏ (`api.ts`, `index.ts`, `jitsi.ts`) ุชุนุชุจุฑ **Deprecated**.
- ุชู ููู ููุทู ุงููุณุงุฑุงุช ุจุงููุงูู ุฅูู ูุฌูุฏุงุช ุงูููุฒุงุช ุฏุงุฎู `src/modules/api/`.
- ูุชู ุงูุงุญุชูุงุธ ุจูุง ููุท ููุชูุงูููุฉ ูุน ุงูุฃููุงุฏ ุงููุฏููุฉ ุฅู ูุฌุฏุช.

---

## ๐ ุงูุซูุงุจุช ูุงูุจูุงูุงุช: src/shared/

- `constants.ts`: ูุญุชูู ุนูู ุซูุงุจุช ุงูุฃููุงู ูุงูุฃููููุงุช ููู ุชุตููู ูุชุตููู ูุฑุนู (`CATEGORY_COLORS`, `SUBCATEGORY_ICONS`).
- `seed-data.ts`: ูุญุชูู ุนูู ุจูุงูุงุช ุชุฌุฑูุจูุฉ (Sample Data) ูููุณุชุฎุฏููู ูุงูููุงูุณุงุช ูุงูุชุตูููุงุชุ ูุน ุฏุงูุฉ `generateSeedSQL` ูุชูููุฏ ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ููุงุนุฏุฉ ุงูุจูุงูุงุช.

---
**ุชู ุฅุนุฏุงุฏ ูุฐุง ุงูุชูุซูู ููููู ูุฑุฌุนุงู ูููุทูุฑูู ุญูู ููููุฉ ุนูู ุงูุฃุฌุฒุงุก ุงููุดุชุฑูุฉ ูููุทุฉ ุงูุจุฏุงูุฉ ููุชุทุจูู.**
